<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <title>Dazzling Animals NFT 관리자 대시보드</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Dazzling Animals NFT 컬렉션 관리 도구 – Ethereum Mainnet / Sepolia Testnet 지원">

  <!-- 라이브러리 -->
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

  <!-- 프로젝트 파일 -->
  <link rel="stylesheet" href="styles.css">
  <script defer type="text/javascript" src="contract.js"></script>
  <script defer type="text/javascript" src="utils.js"></script>
  <script defer type="text/javascript" src="wallet.js"></script>
  <script defer type="text/javascript" src="minting.js"></script>
  <script defer type="text/javascript" src="settings.js"></script>
  <script defer type="text/javascript" src="queries.js"></script>

  <style>
    /* 네트워크 선택 버튼 */
    .network-selector {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }

    .network-btn {
      padding: 10px 20px;
      border: 2px solid #555;
      border-radius: 8px;
      background: rgba(40, 44, 52, 0.9);
      color: #b8b8b8;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
    }

    .network-btn:hover {
      border-color: #00ffcc;
      color: #00ffcc;
    }

    .network-btn.active {
      border-color: #00ffcc;
      background: rgba(0, 255, 204, 0.15);
      color: #00ffcc;
    }

    .network-btn.testnet {
      border-color: #ffc107;
    }

    .network-btn.testnet.active {
      border-color: #ffc107;
      background: rgba(255, 193, 7, 0.15);
      color: #ffc107;
    }

    .testnet-badge {
      background: #ffc107;
      color: #000;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.7em;
      margin-left: 5px;
    }

    /* Textarea 스타일 */
    .multi-input-textarea {
      width: calc(100% - 20px);
      min-height: 150px;
      padding: 12px;
      border: 1px solid #555;
      border-radius: 6px;
      background-color: #2a2a2a;
      color: #e0e0e0;
      font-family: monospace;
      font-size: 13px;
      resize: vertical;
    }

    .multi-input-textarea:focus {
      border-color: #00ffcc;
      outline: none;
      box-shadow: 0 0 10px rgba(0, 255, 204, 0.2);
    }

    /* 대시보드 그리드 */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .dashboard-card {
      background: rgba(40, 44, 52, 0.9);
      border: 1px solid #404040;
      border-radius: 8px;
      padding: 15px;
      border-left: 3px solid #00ffcc;
    }

    .dashboard-card-title {
      font-size: 0.9em;
      color: #00ffcc;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .dashboard-card-value {
      font-size: 1.3em;
      color: #ffffff;
      font-weight: 700;
    }

    /* 설명 박스 */
    .function-desc {
      background: rgba(0, 255, 204, 0.05);
      border-left: 3px solid #00ffcc;
      padding: 10px;
      margin: 10px 0;
      font-size: 0.9em;
      color: #b8b8b8;
      border-radius: 4px;
    }

    /* 권한 배지 */
    .wallet-role.operator {
      background: linear-gradient(135deg, rgba(0, 184, 217, 0.2) 0%, rgba(0, 150, 180, 0.2) 100%);
      border-left: 4px solid #00b8d9;
      color: #00b8d9;
    }

    /* 체크박스 스타일 */
    .checkbox-container {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 6px;
      margin: 10px 0;
    }

    .checkbox-container input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .checkbox-container label {
      cursor: pointer;
      user-select: none;
    }

    /* 경고 박스 */
    .warning-box {
      background: rgba(255, 107, 107, 0.1);
      border-left: 4px solid #ff6b6b;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
    }

    .warning-box h3 {
      color: #ff6b6b;
      margin-top: 0;
    }

    /* 성공 박스 */
    .success-box {
      background: rgba(0, 255, 204, 0.1);
      border-left: 4px solid #00ffcc;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
    }

    .success-box h3 {
      color: #00ffcc;
      margin-top: 0;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- 헤더/네비 -->
    <header class="main-header"
      style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
      <div>
        <h1>✨ Dazzling Animals NFT<br> 관리자 대시보드</h1>
        <p class="subtitle">Dazzling Animals NFT 컬렉션을 쉽고 안전하게 관리하세요</p>
      </div>
      <nav>
        <a class="btn-secondary" href="./guide.html" target="_blank"
          style="text-decoration:none;display:inline-block;padding:10px 14px;border-radius:8px;">📖 사용 가이드</a>
      </nav>
    </header>

    <!-- 네트워크 선택 -->
    <section class="wallet-section">
      <h3 style="margin-top:0;color:#00ffcc;">🌐 네트워크 선택</h3>
      <div class="network-selector">
        <button class="network-btn active" data-chain-id="1" onclick="selectNetwork(1)">
          <span style="color:#627eea;">◈</span> Ethereum Mainnet
        </button>
        <button class="network-btn testnet" data-chain-id="11155111" onclick="selectNetwork(11155111)">
          <span style="color:#ffc107;">◈</span> Sepolia Testnet
          <span class="testnet-badge">테스트</span>
        </button>
      </div>

      <div id="currentNetworkDisplay"
        style="display:flex;align-items:center;gap:10px;padding:10px 16px;background:rgba(0,255,204,0.1);border-radius:8px;border:1px solid #00ffcc;margin-bottom:15px;">
        <span style="font-weight:600;color:#00ffcc;">🌐 네트워크:</span>
        <span style="font-weight:700;color:#fff;">Ethereum Mainnet</span>
      </div>

      <div class="wallet-connection" style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;">
        <button class="btn-connect-wallet" onclick="connectWallet()">🔗 지갑 연결 (MetaMask)</button>
      </div>
      <div class="connection-help">
        <small>💡 MetaMask가 없다면 <a href="https://metamask.io" target="_blank" style="color:#00ffcc;">설치</a>하세요.</small>
      </div>

      <div class="wallet-info">
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">🏠 지갑 주소:</span>
            <span id="walletAddress" class="info-value">연결되지 않음</span>
          </div>
          <div class="info-item">
            <span class="info-label">💰 네이티브 잔고:</span>
            <span id="walletBalance" class="info-value">-</span>
          </div>
          <div class="info-item">
            <span class="info-label">🎨 NFT 보유:</span>
            <span id="nftBalance" class="info-value">-</span>
          </div>
          <div class="info-item">
            <span class="info-label">🔑 권한 레벨:</span>
            <span id="walletRole" class="wallet-role">연결되지 않음</span>
          </div>
        </div>
      </div>
    </section>

    <!-- 대시보드 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        📊 대시보드
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">컨트랙트 실시간 정보</span>
      </h2>
      <div class="category-content">
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <div class="dashboard-card-title">📛 컬렉션 이름</div>
            <div id="ds_name" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🏷️ 심볼</div>
            <div id="ds_symbol" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">📦 총 발행량</div>
            <div id="ds_totalSupply" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🎨 실제 발행됨</div>
            <div id="ds_totalMinted" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🎯 최대 발행량</div>
            <div id="ds_maxSupply" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🔄 현재 라운드 (Epoch)</div>
            <div id="ds_currentEpoch" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🤍 화이트리스트 1회 제한</div>
            <div id="ds_maxWhitelistMintPerTx" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🌍 퍼블릭 1회 제한</div>
            <div id="ds_maxPublicMintPerTx" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">👥 화이트리스트 배치</div>
            <div id="ds_maxWhitelistBatchSize" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">⚙️ 운영자 최대 민팅</div>
            <div id="ds_maxOperatorMintAmount" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">⏸️ 일시정지 상태</div>
            <div id="ds_paused" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🤍 화이트리스트 판매</div>
            <div id="ds_whitelistStart" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🌍 퍼블릭 판매</div>
            <div id="ds_publicStart" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">💰 화이트리스트 가격</div>
            <div id="ds_whitelistCost" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">💵 퍼블릭 가격</div>
            <div id="ds_publicCost" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">🏁 판매 종료 ID</div>
            <div id="ds_saleEndTokenId" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">💸 출금 주소</div>
            <div id="ds_withdrawalAddress" class="dashboard-card-value">-</div>
          </div>
          <div class="dashboard-card">
            <div class="dashboard-card-title">💎 컨트랙트 잔액</div>
            <div id="ds_contractBalance" class="dashboard-card-value">-</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Explorer 바로가기 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        🔍 Explorer 바로가기
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">컨트랙트/토큰 트래커/홀더 보기</span>
      </h2>
      <div class="category-content">
        <div class="explorer-links" style="display:flex;gap:10px;flex-wrap:wrap;">
          <a id="explorerContract" href="#" target="_blank" class="btn-external">
            📄 컨트랙트 보기
          </a>
          <a id="explorerToken" href="#" target="_blank" class="btn-external">
            🎨 NFT 트래커
          </a>
          <a id="explorerHolders" href="#" target="_blank" class="btn-external">
            👥 홀더 보기
          </a>
        </div>
      </div>
    </section>

    <!-- Owner 민팅 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        👑 Owner 민팅(+에어 드랍)
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">관리자/운영자가 특정 주소로 NFT 발행</span>
      </h2>
      <div class="category-content">
        <p class="note">⚠️ Owner 또는 Operator 권한이 필요합니다. 한 번에 최대 100개까지 민팅 가능합니다.</p>

        <div class="form-group">
          <label class="form-label">🎨 NFT 민팅(+에어 드랍) <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">특정 주소로 NFT를 직접 발행합니다. 가스비만 소모되며 민팅 비용은 들지 않습니다. 최대 발행량을 초과할 수 없습니다.</p>
          <input type="text" id="mintTo" placeholder="받는 주소 (0x...)" class="form-input">
          <input type="number" id="mintAmount" placeholder="민팅 수량 (1~100)" class="form-input" min="1" max="100"
            step="1">
          <button class="btn-primary" onclick="ownerMint()">민팅 실행</button>
          <small class="note">💡 예시: 0x123...abc 주소로 10개 민팅</small>
        </div>
      </div>
    </section>

    <!-- 화이트리스트 관리 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        🤍 화이트리스트 관리
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">화이트리스트 추가/제거/조회</span>
      </h2>
      <div class="category-content">
        <p class="note">⚠️ Operator 권한이 필요합니다. 한 번에 최대 100개의 주소를 처리할 수 있습니다.</p>

        <!-- 일괄 추가 (칸 생성 방식) -->
        <div class="form-group">
          <label class="form-label">➕ 화이트리스트 일괄 추가 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">주소 개수를 입력하면 그 수만큼 입력칸이 생성됩니다. (최대 100개)</p>

          <label class="form-label">🧩 주소 칸 생성 (1~100)</label>
          <div style="display:flex; gap:10px; align-items:center; margin-bottom:10px;">
            <input type="number" id="whitelistAddCount" class="form-input" min="1" max="100" step="1"
              placeholder="예: 30" oninput="renderWhitelistInputs('add')" />
          </div>

          <div id="whitelistAddInputs" class="address-grid"></div>

          <div id="whitelistPreview" class="result-display"></div>
          <button class="btn-primary" onclick="addWhitelistBatch()">일괄 추가</button>
          <small class="note">💡 중복된 주소는 자동으로 제거됩니다.</small>
        </div>

        <!-- 일괄 제거 (칸 생성 방식) -->
        <div class="form-group">
          <label class="form-label">➖ 화이트리스트 일괄 제거 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">주소 개수를 입력하면 그 수만큼 입력칸이 생성됩니다. (최대 100개)</p>

          <label class="form-label">🧩 주소 칸 생성 (1~100)</label>
          <div style="display:flex; gap:10px; align-items:center; margin-bottom:10px;">
            <input type="number" id="whitelistRemoveCount" class="form-input" min="1" max="100" step="1"
              placeholder="예: 30" oninput="renderWhitelistInputs('remove')" />
          </div>

          <div id="whitelistRemoveInputs" class="address-grid"></div>

          <div id="whitelistRemovePreview" class="result-display"></div>
          <button class="btn-danger" onclick="removeWhitelistBatch()">일괄 제거</button>
          <small class="note">💡 이미 화이트리스트가 아닌 주소는 건너뜁니다.</small>
        </div>


        <!-- 개별 설정 -->
        <div class="form-group">
          <label class="form-label">⚙️ 개별 화이트리스트 설정 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">하나의 주소에 대해 화이트리스트 상태를 설정합니다.</p>
          <input type="text" id="whitelistSingleAddress" placeholder="주소 (0x...)" class="form-input">
          <select id="whitelistSingleStatus" class="form-input">
            <option value="true">추가</option>
            <option value="false">제거</option>
          </select>
          <button class="btn-primary" onclick="setWhitelistSingle()">설정</button>
          <small class="note">💡 개별 주소의 화이트리스트 상태를 변경합니다.</small>
        </div>
      </div>
    </section>

    <!-- 판매 설정 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        💰 판매 설정
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">라운드 시작, 가격, 판매 기간 설정</span>
      </h2>
      <div class="category-content">
        <p class="note">⚠️ Operator 권한이 필요합니다. 판매 설정은 신중하게 진행하세요.</p>

        <!-- 🔥 새 라운드 시작 (Epoch) - 간편 버전 -->
        <div class="form-group">
          <label class="form-label">🔄 새 라운드 시작 (월별 한도 초기화) <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">
            <strong>매달 새로운 세일 라운드를 시작합니다.</strong> 
            버튼 하나로 모든 사용자의 월별 민팅 한도가 <strong style="color:#ff6b6b;">자동으로 초기화</strong>됩니다.
          </p>

          <div class="warning-box" style="background: rgba(255, 107, 107, 0.1); border-left: 4px solid #ff6b6b;">
            <h3>⚠️ 매우 중요한 주의사항!</h3>
            <ul style="margin: 10px 0; padding-left: 20px;">
              <li><strong style="color:#ff6b6b;">이 함수는 되돌릴 수 없습니다!</strong></li>
              <li>라운드 번호가 증가하면 <strong>모든 사용자가 다시 민팅 가능</strong>해집니다.</li>
              <li>트랜잭션 취소 알람이 떠도 <strong>트랜잭션이 실제로 성공했을 수 있습니다.</strong></li>
              <li>⚡ <strong>현재 라운드 조회</strong>를 통해 라운드 번호가 월 수와 일치하는지 확인하세요!</li>
              <li>실수로 두 번 눌렀다면 라운드가 의도치 않게 증가했을 수 있습니다!</li>
            </ul>
            <div style="background: rgba(0, 255, 204, 0.1); padding: 10px; border-radius: 4px; margin-top: 10px;">
              <strong style="color: #00ffcc;">📅 라운드 번호 = 월</strong><br>
              <small style="color: #b8b8b8;">
                라운드 0 = 세일 미시작<br>
                라운드 1 = 1월 세일<br>
                라운드 2 = 2월 세일<br>
                라운드 3 = 3월 세일<br>
                ...계속...
              </small>
            </div>
          </div>

          <div style="background: rgba(0, 255, 204, 0.1); padding: 15px; border-radius: 6px; border-left: 3px solid #00ffcc; margin: 15px 0;">
            <h4 style="margin: 0 0 10px 0; color: #00ffcc;">💡 사용 전 체크리스트</h4>
            <ol style="margin: 0; padding-left: 20px; color: #e0e0e0;">
              <li>화이트리스트 주소 업데이트 완료 ✅</li>
              <li>판매 설정(가격, 종료 ID) 완료 ✅</li>
              <li>현재 라운드 번호 확인 완료 ✅</li>
              <li>팀원들에게 공지 완료 ✅</li>
            </ol>
          </div>

          <button class="btn-warning" onclick="startNewRound()" style="margin-top:15px; font-size:18px; padding:15px 30px; width:100%;">
            🚀 새 라운드 시작 (Epoch 증가)
          </button>
          <small class="note" style="display:block; margin-top:10px; color:#ff6b6b; text-align:center;">
            ⚠️ 이 버튼은 되돌릴 수 없습니다! 신중하게 클릭하세요.
          </small>
        </div>

        <!-- 🔍 현재 라운드 조회 -->
        <div class="form-group">
          <label class="form-label">🔍 현재 라운드(Epoch) 조회 <span class="free-badge">무료</span></label>
          <p class="function-desc">
            현재 진행 중인 라운드 번호를 조회합니다. 라운드 번호는 월을 의미합니다.
          </p>
          <button class="btn-secondary" onclick="getCurrentEpoch()">현재 라운드 조회</button>
          <div id="currentEpochResult" class="result-display"></div>
          <small class="note">
            💡 새 라운드를 시작한 후 여기서 라운드 번호가 증가했는지 확인하세요!<br>
            💡 라운드 0 = 아직 세일 미시작
          </small>
        </div>

        <hr style="border: 1px solid #404040; margin: 30px 0;">

        <!-- 종합 판매 설정 -->
        <div class="form-group">
          <label class="form-label">⚙️ 종합 판매 설정 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">화이트리스트/퍼블릭 판매 가격, 판매 종료 토큰 ID, 시작/중지 상태를 한 번에 설정합니다.</p>

          <div class="warning-box">
            <h3>⚠️ 중요: 판매 종료 토큰 ID</h3>
            <p><strong>판매 종료 토큰 ID</strong>는 해당 판매 라운드에서 발행할 수 있는 마지막 토큰의 ID입니다.</p>
            <p>예시: 종료 ID를 <strong>500</strong>으로 설정하면, 이번 라운드에서는 <strong>500번까지만</strong> 민팅 가능합니다.</p>
            <p>💡 다음 라운드를 위해서는 이 값을 증가시켜야 합니다 (예: 500 → 1000).</p>
            <p>💡 잘못된 값을 입력했다면, 컨트랙트 정지 후 최소 현재 민팅된 개수만큼 감소시킬 수 있습니다. 대신 주의해 주세요(예: 1222 -> 122) </p>
          </div>

          <label style="font-size:0.9em;margin-bottom:5px;display:block;">화이트리스트 가격 (ETH)</label>
          <input type="number" id="saleWhitelistCost" placeholder="0.01" class="form-input" min="0" step="0.001">

          <label style="font-size:0.9em;margin-bottom:5px;display:block;">퍼블릭 가격 (ETH)</label>
          <input type="number" id="salePublicCost" placeholder="0.02" class="form-input" min="0" step="0.001">

          <label style="font-size:0.9em;margin-bottom:5px;display:block;">판매 종료 토큰 ID</label>
          <input type="number" id="saleEndTokenId" placeholder="500" class="form-input" min="1" step="1">

          <div class="checkbox-container">
            <input type="checkbox" id="saleWhitelistStart">
            <label for="saleWhitelistStart">화이트리스트 판매 시작</label>
          </div>

          <div class="checkbox-container">
            <input type="checkbox" id="salePublicStart">
            <label for="salePublicStart">퍼블릭 판매 시작</label>
          </div>

          <button class="btn-primary" onclick="setSaleConfig()">판매 설정 적용</button>
          <small class="note">💡 모든 판매 관련 설정을 한 번에 업데이트합니다.</small>
        </div>

        <!-- 빠른 판매 토글 -->
        <div class="form-group">
          <label class="form-label">🚀 빠른 판매 시작/중지 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">판매 시작/중지만 빠르게 변경합니다. (가격 및 종료 ID는 변경되지 않음)</p>

          <div class="checkbox-container">
            <input type="checkbox" id="quickWhitelistStart">
            <label for="quickWhitelistStart">화이트리스트 판매 정지/시작</label>
            <button class="btn-secondary" onclick="toggleWhitelistSale()" style="margin-left:10px;">적용</button>
          </div>

          <div class="checkbox-container">
            <input type="checkbox" id="quickPublicStart">
            <label for="quickPublicStart">퍼블릭 판매 정지/시작</label>
            <button class="btn-secondary" onclick="togglePublicSale()" style="margin-left:10px;">적용</button>
          </div>
          
          <small class="note">💡 체크박스를 체크하고 적용을 누르면 시작, 풀고 적용을 누르면 정지 입니다. 참고하세요.</small>
          <small class="note">💡 체크박스 유무에 따라 현재 상태를 변화시킵니다. LIVE 상태에서 체크를 하고 적용누르면 변화가 없습니다.</small>
        </div>
      </div>
    </section>

    <!-- 조회 기능 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        🔎 조회 기능
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">화이트리스트, NFT 보유량, 권한, 민팅 상태 조회</span>
      </h2>
      <div class="category-content">
        <p class="note">💡 누구나 조회 가능합니다. 가스비가 들지 않는 <strong>읽기 전용 함수</strong>입니다.</p>

        <!-- 화이트리스트 조회 -->
        <div class="form-group">
          <label class="form-label">🤍 화이트리스트 여부 조회<span class="free-badge">무료</span></label>
          <p class="function-desc">특정 주소가 화이트리스트에 등록되어 있는지 확인합니다.</p>
          <div class="input-group">
            <input type="text" id="checkWhitelistAddress" placeholder="조회할 주소 (0x...)" class="form-input"
              style="flex:1;">
            <button class="btn-secondary" onclick="checkWhitelist()">조회</button>
          </div>
          <div id="whitelistResult" class="result-display"></div>
        </div>

        <!-- NFT 보유량 조회 -->
        <div class="form-group">
          <label class="form-label">🎨 NFT 보유량 조회<span class="free-badge">무료</span></label>
          <p class="function-desc">특정 주소가 보유한 NFT 개수를 조회합니다.</p>
          <div class="input-group">
            <input type="text" id="checkNFTBalanceAddress" placeholder="조회할 주소 (0x...)" class="form-input"
              style="flex:1;">
            <button class="btn-secondary" onclick="checkNFTBalance()">조회</button>
          </div>
          <div id="nftBalanceResult" class="result-display"></div>
        </div>

        <!-- 토큰 URI 조회 -->
        <div class="form-group">
          <label class="form-label">🔗 토큰 URI 조회 <span class="free-badge">무료</span></label>
          <p class="function-desc">특정 토큰 ID의 메타데이터 URI를 조회합니다. (예: tokenURI(1) → https://api.example.com/metadata/1.json)</p>
          <div class="input-group">
            <input type="number" id="checkTokenURIId" placeholder="토큰 ID (예: 1)" class="form-input" min="1" step="1" style="flex:1;">
            <button class="btn-secondary" onclick="checkTokenURI()">조회</button>
          </div>
          <div id="tokenURIResult" class="result-display"></div>
          <small class="note">💡 토큰이 아직 민팅되지 않은 경우 에러가 발생합니다.</small>
        </div>

        <!-- 권한 조회 -->
        <div class="form-group">
          <label class="form-label">🔑 권한 조회<span class="free-badge">무료</span></label>
          <p class="function-desc">특정 주소의 권한 레벨(Admin/Operator/User)을 조회합니다.</p>
          <div class="input-group">
            <input type="text" id="checkRoleAddress" placeholder="조회할 주소 (0x...)" class="form-input" style="flex:1;">
            <button class="btn-secondary" onclick="checkRole()">조회</button>
          </div>
          <div id="roleResult" class="result-display"></div>
        </div>

        <!-- 화이트리스트 민팅 상태 조회 -->
        <div class="form-group">
          <label class="form-label">🤍 화이트리스트 민팅 상태 조회<span class="free-badge">무료</span></label>
          <p class="function-desc">특정 주소의 화이트리스트 민팅 가능 여부, 가격, 남은 수량 등을 조회합니다.</p>
          <div class="input-group">
            <input type="text" id="checkWhitelistMintAddress" placeholder="조회할 주소 (0x...)" class="form-input"
              style="flex:1;">
            <button class="btn-secondary" onclick="checkWhitelistMintStatus()">조회</button>
          </div>
          <div id="whitelistMintStatusResult" class="result-display"></div>
        </div>

        <!-- 퍼블릭 민팅 상태 조회 -->
        <div class="form-group">
          <label class="form-label">🌍 퍼블릭 민팅 상태 조회<span class="free-badge">무료</span></label>
          <p class="function-desc">퍼블릭 민팅 가능 여부, 가격, 남은 수량 등을 조회합니다. 주소를 입력하면 해당 주소의 민팅 현황도 확인할 수 있습니다.</p>
          <div class="input-group">
            <input type="text" id="checkPublicMintAddress" placeholder="(선택) 조회할 주소 (0x...)" class="form-input" style="flex:1;">
            <button class="btn-secondary" onclick="checkPublicMintStatus()">조회</button>
          </div>
          <div id="publicMintStatusResult" class="result-display"></div>
          <small class="note">💡 주소를 입력하지 않으면 전체 퍼블릭 민팅 상태만 조회됩니다.</small>
        </div>

        <!-- 사용자 민팅 현황 조회 (Epoch별) -->
        <div class="form-group">
          <label class="form-label">📊 사용자 민팅 현황 조회 (현재 Epoch) <span class="free-badge">무료</span></label>
          <p class="function-desc">특정 주소가 현재 Epoch(라운드)에서 화이트리스트/퍼블릭으로 각각 얼마나 민팅했는지 조회합니다.</p>
          <div class="input-group">
            <input type="text" id="checkUserMintInfoAddress" placeholder="조회할 주소 (0x...)" class="form-input" style="flex:1;">
            <button class="btn-secondary" onclick="checkUserMintInfo()">조회</button>
          </div>
          <div id="userMintInfoResult" class="result-display"></div>
          <small class="note">💡 현재 라운드에서의 민팅 현황을 확인할 수 있습니다.</small>
        </div>
      </div>
    </section>

        <!-- 권한 관리 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        👥 권한 관리
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">Admin/Operator 추가 및 제거</span>
      </h2>
      <div class="category-content">
        <p class="note">⚠️ Admin 권한이 필요합니다. 권한 부여/제거는 신중하게 진행하세요.</p>

        <div class="warning-box">
          <h3>⚠️ 권한 구조</h3>
          <ul>
            <li><strong>Admin (관리자)</strong>: 모든 권한 보유. 다른 Admin/Operator 추가/제거 가능</li>
            <li><strong>Operator (운영자)</strong>: 민팅, 화이트리스트, 판매 설정 등 일상적인 관리 가능</li>
            <li><strong>User (일반 사용자)</strong>: 민팅 및 NFT 전송만 가능</li>
          </ul>
        </div>

        <!-- 운영자 권한 부여 -->
        <div class="form-group">
          <label class="form-label">➕ 운영자 권한 부여 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">특정 주소에 Operator 권한을 부여합니다. Operator는 민팅, 화이트리스트 관리, 판매 설정 등을 할 수 있습니다.</p>
          <input type="text" id="operatorAddress" placeholder="운영자 주소 (0x...)" class="form-input">
          <button class="btn-primary" onclick="grantOperatorRole()">운영자 권한 부여</button>
          <small class="note">💡 신뢰할 수 있는 팀원에게만 권한을 부여하세요.</small>
        </div>

        <!-- 운영자 권한 제거 -->
        <div class="form-group">
          <label class="form-label">➖ 운영자 권한 제거 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">특정 주소의 Operator 권한을 제거합니다.</p>
          <input type="text" id="revokeOperatorAddress" placeholder="제거할 운영자 주소 (0x...)" class="form-input">
          <button class="btn-danger" onclick="revokeOperatorRole()">운영자 권한 제거</button>
          <small class="note">⚠️ 권한 제거 후 해당 주소는 관리 기능을 사용할 수 없습니다.</small>
        </div>

        <!-- 관리자 권한 부여 -->
        <div class="form-group">
          <label class="form-label">👑 관리자 권한 부여 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">특정 주소에 Admin 권한을 부여합니다. <strong style="color:#ff6b6b;">Admin은 모든 권한을 가지므로 매우 신중하게
              부여하세요.</strong></p>
          <input type="text" id="adminAddress" placeholder="관리자 주소 (0x...)" class="form-input">
          <button class="btn-primary" onclick="grantAdminRole()">관리자 권한 부여</button>
          <small class="note">⚠️ 관리자는 다른 관리자를 추가/제거할 수 있습니다.</small>
        </div>

        <!-- 관리자 권한 제거 -->
        <div class="form-group">
          <label class="form-label">🚫 관리자 권한 제거 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">특정 주소의 Admin 권한을 제거합니다.</p>
          <input type="text" id="revokeAdminAddress" placeholder="제거할 관리자 주소 (0x...)" class="form-input">
          <button class="btn-danger" onclick="revokeAdminRole()">관리자 권한 제거</button>
          <small class="note">⚠️ 자신의 관리자 권한을 제거하면 되돌릴 수 없습니다!</small>
        </div>
      </div>
    </section>

    <!-- 기본 설정 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        ⚙️ 기본 설정
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">URI, 로열티, 일시정지, 출금</span>
      </h2>
      <div class="category-content">
        <p class="note">⚠️ 설정에 따라 Admin 또는 Operator 권한이 필요합니다.</p>

        <!-- Base URI -->
        <div class="form-group">
          <label class="form-label">🔗 Base URI 설정 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">NFT 메타데이터의 기본 URI를 설정합니다. 각 토큰의 메타데이터는 <code>baseURI + tokenId + ".json"</code> 형식으로
            조회됩니다.</p>
          <input type="text" id="newBaseURI" placeholder="https://api.example.com/metadata/" class="form-input">
          <button class="btn-primary" onclick="setBaseURI()">Base URI 설정</button>
          <small class="note">💡 IPFS 예시: ipfs://QmXXXXX/ (슬래시 필수)</small>
        </div>

        <!-- 일시정지 -->
        <div class="form-group">
          <label class="form-label">⏸️ 일시정지 (긴급 차단) <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">
            <strong>모든 NFT 관련 활동을 완전히 차단</strong>합니다. 
            긴급 상황(해킹, 버그 발견 등)에만 사용하세요.
          </p>
          
          <div style="background: rgba(255, 107, 107, 0.1); padding: 12px; border-radius: 6px; border-left: 3px solid #ff6b6b; margin-bottom: 10px;">
            <strong style="color: #ff6b6b;">⚠️ 일시정지 시 차단되는 기능:</strong>
            <ul style="margin: 8px 0; padding-left: 20px; color: #e0e0e0;">
              <li>✋ 사용자 민팅 (화이트리스트/퍼블릭)</li>
              <li>✋ 운영자 민팅 (Owner 민팅)</li>
              <li>✋ NFT 전송 (지갑 간 이동)</li>
              <li>✋ OpenSea 등 2차 마켓 거래</li>
              <li>✋ NFT 소각 (Burn)</li>
            </ul>
          </div>
          
          <div class="checkbox-container">
            <input type="checkbox" id="pauseCheckbox">
            <label for="pauseCheckbox">일시정지 활성화</label>
            <button class="btn-warning" onclick="togglePause()" style="margin-left:10px;">적용</button>
          </div>
          <small class="note">💡 문제 해결 후 반드시 일시정지를 해제해야 합니다.</small>
        </div>

        <!-- 로열티 -->
        <div class="form-group">
          <label class="form-label">💎 로열티 설정 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">NFT 2차 판매 시 발생하는 로열티 비율과 수신자 주소를 설정합니다. (EIP-2981 표준)</p>
          <input type="text" id="royaltyReceiver" placeholder="로열티 수신자 주소 (0x...)" class="form-input">
          <input type="number" id="royaltyPercentage" placeholder="로열티 비율 (%, 0~10)" class="form-input" min="0" max="10"
            step="0.1">
          <button class="btn-primary" onclick="setRoyalty()">로열티 설정</button>
          <small class="note">💡 최대 10%까지 설정 가능합니다. (예: 5% = 5 입력)</small>
        </div>

        <!-- 출금 주소 -->
        <div class="form-group">
          <label class="form-label">💸 출금 주소 설정 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">민팅으로 받은 ETH를 출금할 주소를 설정합니다.</p>
          <input type="text" id="newWithdrawalAddress" placeholder="출금 주소 (0x...)" class="form-input">
          <button class="btn-primary" onclick="setWithdrawalAddress()">출금 주소 설정</button>
          <small class="note">💡 출금 주소를 변경해도 기존 잔액은 유지됩니다.</small>
        </div>

        <!-- ETH 출금 -->
        <div class="form-group">
          <label class="form-label">💰 ETH 출금 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">컨트랙트에 쌓인 모든 ETH를 출금 주소로 전송합니다.</p>
          <button class="btn-success" onclick="withdrawFunds()">전액 출금</button>
          <small class="note">⚠️ 출금 주소가 미리 설정되어 있어야 합니다.</small>
        </div>
      </div>
    </section>

        <!-- 제한 설정 -->
    <section class="category">
      <h2 onclick="toggleCategory(this)" class="category-header">
        🎯 제한 설정(운영 정책이 변경될 시 실행)
        <span class="toggle-icon">&#9662;</span>
        <span class="category-desc">발행량, 민팅 수량 제한</span>
      </h2>
      <div class="category-content">
        <p class="note">⚠️ 설정에 따라 Admin 또는 Operator 권한이 필요합니다.</p>

        <!-- 최대 발행량 -->
        <div class="form-group">
          <label class="form-label">📦 최대 발행량 설정 <span class="required-badge">ADMIN</span></label>
          <p class="function-desc">NFT 컬렉션의 최대 발행 가능 수량을 설정합니다. <strong>이미 발행된 수량보다 작게 설정할 수 없습니다.</strong></p>
          <input type="number" id="newMaxSupply" placeholder="예: 10000" class="form-input" min="1" step="1">
          <button class="btn-primary" onclick="setMaxSupply()">최대 발행량 설정</button>
          <small class="note">💡 현재 발행량 및 판매 종료 ID보다 크거나 같아야 합니다.</small>
        </div>

        <!-- 화이트리스트 트랜잭션당 민팅 제한 -->
        <div class="form-group">
          <label class="form-label">🤍 화이트리스트 1회 민팅 제한 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">화이트리스트 사용자가 한 번의 트랜잭션으로 민팅할 수 있는 최대 NFT 개수를 설정합니다. (Epoch당 최대 2개 제한 내에서)</p>
          <input type="number" id="newMaxWhitelistMintPerTx" placeholder="예: 2 (최대 2개)" class="form-input" min="1" max="2" step="1">
          <button class="btn-primary" onclick="setMaxWhitelistMintPerTx()">설정</button>
          <small class="note">💡 Epoch당 총 2개까지만 민팅 가능하므로, 이 값은 1 또는 2만 설정 가능합니다.</small>
        </div>

        <!-- 퍼블릭 트랜잭션당 민팅 제한 -->
        <div class="form-group">
          <label class="form-label">🌍 퍼블릭 1회 민팅 제한 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">퍼블릭 사용자가 한 번의 트랜잭션으로 민팅할 수 있는 최대 NFT 개수를 설정합니다. (Epoch당 최대 12개 제한 내에서)</p>
          <input type="number" id="newMaxPublicMintPerTx" placeholder="예: 12 (최대 12개)" class="form-input" min="1" max="12" step="1">
          <button class="btn-primary" onclick="setMaxPublicMintPerTx()">설정</button>
          <small class="note">💡 Epoch당 총 12개까지만 민팅 가능하므로, 이 값은 1~12 사이로 설정 가능합니다.</small>
        </div>

        <!-- 화이트리스트 배치 크기 -->
        <div class="form-group">
          <label class="form-label">👥 화이트리스트 배치 크기 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">한 번에 처리할 수 있는 화이트리스트 주소의 최대 개수를 설정합니다.</p>
          <input type="number" id="newMaxWhitelistBatchSize" placeholder="예: 100" class="form-input" min="1" max="300"
            step="1">
          <button class="btn-primary" onclick="setMaxWhitelistBatchSize()">설정</button>
          <small class="note">💡 최대 300개까지 설정 가능하지만, 가스 한도를 고려하세요.</small>
        </div>

        <!-- 운영자 최대 민팅 수량 -->
        <div class="form-group">
          <label class="form-label">⚙️ 운영자 최대 민팅 수량 <span class="required-badge">OPERATOR</span></label>
          <p class="function-desc">운영자가 한 번의 트랜잭션으로 민팅할 수 있는 최대 NFT 개수를 설정합니다.</p>
          <input type="number" id="newMaxOperatorMintAmount" placeholder="예: 100" class="form-input" min="1" step="1">
          <button class="btn-primary" onclick="setMaxOperatorMintAmount()">설정</button>
          <small class="note">💡 에어드랍이나 대량 민팅 시 사용됩니다.</small>
        </div>
      </div>
    </section>

    <footer style="margin-top:32px;text-align:center;opacity:0.8;">
      <small>© Dazzling Animals NFT Admin • Ethereum / Sepolia Dashboard</small>
    </footer>
  </div>

  <script>
    // 카테고리 토글 함수
    function toggleCategory(el) {
      const content = el.parentElement.querySelector('.category-content');
      const icon = el.querySelector('.toggle-icon');
      if (content.style.display === 'block') {
        content.style.display = 'none';
        icon.innerHTML = '&#9662;';
      } else {
        content.style.display = 'block';
        icon.innerHTML = '&#9652;';
      }
    }
  </script>
</body>

</html>
